/*
 * chosen-remote-source
 * @version v0.9.0
 * @link http://github.com/westonganger/chosen-remote-source
 * @license MIT
 */
!function(e){var a=".chosen-remote-source",t={delay:250,event:"input",method:"GET",label_field:"label",value_field:"value",search_param:"q",selected_param:"selected"},l=e("<select></select>");l.chosen(),Object.getPrototypeOf(l.data("chosen")).show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.default_text===this.search_field.val()&&this.search_field.val(""),this.search_field.removeClass("default"))};var r=function(){var a=e(this),t=a.val(),l=a.closest(".chosen-container"),r=l.data("chosen-remote-source-opts"),n=l.prev("select"),o=n.val(),s="";"string"==typeof o&&(o=[o]);for(var i=0;i<o.length;i++){var c=n.find("option[value='"+o[i]+"']")[0];c||(c=n.find("option:not([value]):contains("+o[i]+")")[0]),s+=c.outerHTML}var d={};d[r.search_param]=t,d[r.selected_param]=n.val(),e.ajax({url:r.url,dataType:"json",data:d,type:r.method}).done((function(e){for(var a="",t=0;t<e.length;t++)a+="<option value='"+e[t][r.value_field]+"'>"+e[t][r.label_field]+"</option>";s&&(a+=s),n.html(a).val(o).trigger("chosen:updated")}))};e.fn.chosenRemoteSource=function(l){if(!l.url)return console.error("Error: url must be defined"),!1;if(l.event){events_array=l.event.split(" ");for(var n="",o=0;o<events_array.length;o++)0!==o&&(n+=" "),n+=events_array[o]+a;l.event=null}else n="input"+a;var s=[];this.each((function(a,t){var l=e(t).data("chosen");l&&s.push(l.container)}));var i={};i.url=l.url||t.url,i.method=l.method||t.method,i.label_field=l.label_field||t.label_field,i.value_field=l.value_field||t.value_field,i.search_param=l.search_param||t.search_param,i.selected_param=l.selected_param||t.selected_param;var c=function(e,a){var t;return function(){var l=this,r=arguments,n=function(){t=null,a.apply(l,r)};clearTimeout(t),t=setTimeout(n,e)}}(l.delay||t.delay,r);for(o=0;o<s.length;o++)s[o].data("chosen-remote-source-opts",i),s[o].off(a),s[o].on(n,"input.chosen-search-input",c);return this}}(window.jQuery||window.Zepto||window.$);
